data modify storage bob:data Pattern set from storage bob:data Banner.tag.BlockEntityTag.Patterns[0]
data remove storage bob:data Banner.tag.BlockEntityTag.Patterns[0]
data remove storage bob:data DisplayItem

# Convert pattern code to custom model data value
execute if data storage bob:data Pattern{Pattern: "b"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320001
execute if data storage bob:data Pattern{Pattern: "bo"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320002
execute if data storage bob:data Pattern{Pattern: "bri"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320003
execute if data storage bob:data Pattern{Pattern: "mc"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320004
execute if data storage bob:data Pattern{Pattern: "cre"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320005
execute if data storage bob:data Pattern{Pattern: "cr"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320006
execute if data storage bob:data Pattern{Pattern: "cbo"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320007
execute if data storage bob:data Pattern{Pattern: "ld"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320008
execute if data storage bob:data Pattern{Pattern: "rud"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320009
execute if data storage bob:data Pattern{Pattern: "lud"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320010
execute if data storage bob:data Pattern{Pattern: "rd"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320011
execute if data storage bob:data Pattern{Pattern: "flo"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320012
execute if data storage bob:data Pattern{Pattern: "glb"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320013
execute if data storage bob:data Pattern{Pattern: "gra"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320014
execute if data storage bob:data Pattern{Pattern: "gru"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320015
execute if data storage bob:data Pattern{Pattern: "hh"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320016
execute if data storage bob:data Pattern{Pattern: "vh"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320017
execute if data storage bob:data Pattern{Pattern: "vhr"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320018
execute if data storage bob:data Pattern{Pattern: "moj"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320019
execute if data storage bob:data Pattern{Pattern: "pig"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320020
execute if data storage bob:data Pattern{Pattern: "mr"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320021
execute if data storage bob:data Pattern{Pattern: "sku"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320022
execute if data storage bob:data Pattern{Pattern: "ss"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320023
execute if data storage bob:data Pattern{Pattern: "bl"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320024
execute if data storage bob:data Pattern{Pattern: "br"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320025
execute if data storage bob:data Pattern{Pattern: "tl"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320026
execute if data storage bob:data Pattern{Pattern: "tr"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320027
execute if data storage bob:data Pattern{Pattern: "sc"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320028
execute if data storage bob:data Pattern{Pattern: "bs"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320029
execute if data storage bob:data Pattern{Pattern: "cs"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320030
execute if data storage bob:data Pattern{Pattern: "dls"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320031
execute if data storage bob:data Pattern{Pattern: "drs"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320032
execute if data storage bob:data Pattern{Pattern: "ls"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320033
execute if data storage bob:data Pattern{Pattern: "ms"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320034
execute if data storage bob:data Pattern{Pattern: "rs"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320035
execute if data storage bob:data Pattern{Pattern: "ts"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320036
execute if data storage bob:data Pattern{Pattern: "bt"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320037
execute if data storage bob:data Pattern{Pattern: "tt"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320038
execute if data storage bob:data Pattern{Pattern: "bts"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320039
execute if data storage bob:data Pattern{Pattern: "tts"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320040
execute if data storage bob:data Pattern{Pattern: "hhb"} run data modify storage bob:data DisplayItem.tag.CustomModelData set value 4320041

# Convert pattern colour to display colour (RGB)
execute if data storage bob:data Pattern{Color: 0} run data modify storage bob:data DisplayItem.tag.display.color set value 16316664
execute if data storage bob:data Pattern{Color: 1} run data modify storage bob:data DisplayItem.tag.display.color set value 16744728
execute if data storage bob:data Pattern{Color: 2} run data modify storage bob:data DisplayItem.tag.display.color set value 12401844
execute if data storage bob:data Pattern{Color: 3} run data modify storage bob:data DisplayItem.tag.display.color set value 2728405
execute if data storage bob:data Pattern{Color: 4} run data modify storage bob:data DisplayItem.tag.display.color set value 16764457
execute if data storage bob:data Pattern{Color: 5} run data modify storage bob:data DisplayItem.tag.display.color set value 8111640
execute if data storage bob:data Pattern{Color: 6} run data modify storage bob:data DisplayItem.tag.display.color set value 16157100
execute if data storage bob:data Pattern{Color: 7} run data modify storage bob:data DisplayItem.tag.display.color set value 6451571
execute if data storage bob:data Pattern{Color: 8} run data modify storage bob:data DisplayItem.tag.display.color set value 9672076
execute if data storage bob:data Pattern{Color: 9} run data modify storage bob:data DisplayItem.tag.display.color set value 1220253
execute if data storage bob:data Pattern{Color: 10} run data modify storage bob:data DisplayItem.tag.display.color set value 8596660
execute if data storage bob:data Pattern{Color: 11} run data modify storage bob:data DisplayItem.tag.display.color set value 4545214
execute if data storage bob:data Pattern{Color: 12} run data modify storage bob:data DisplayItem.tag.display.color set value 9394997
execute if data storage bob:data Pattern{Color: 13} run data modify storage bob:data DisplayItem.tag.display.color set value 6324502
execute if data storage bob:data Pattern{Color: 14} run data modify storage bob:data DisplayItem.tag.display.color set value 11874601
execute if data storage bob:data Pattern{Color: 15} run data modify storage bob:data DisplayItem.tag.display.color set value 2302760

# Copy name (if the banner had one)
execute if data storage bob:data Banner.tag.display.Name run data modify storage bob:data DisplayItem.tag.display.Name set from storage bob:data Banner.tag.display.Name
execute if data storage bob:data Banner.tag.display.Lore run data modify storage bob:data DisplayItem.tag.display.Lore set from storage bob:data Banner.tag.display.Lore

# Summon armour stand and apply changes
execute if data storage bob:data {Rotation: "west"} run summon minecraft:armor_stand ~ ~0.5625 ~ {Tags: ["bob", "bob.banner_pattern", "bob.updated", "bob.new"], ArmorItems: [{}, {}, {}, {id: "minecraft:leather_horse_armor", Count: 1b}], Invisible: 1b, Marker: 1b, Rotation: [270.0f, 0.0f]}
execute if data storage bob:data {Rotation: "north"} run summon minecraft:armor_stand ~ ~0.5625 ~ {Tags: ["bob", "bob.banner_pattern", "bob.updated", "bob.new"], ArmorItems: [{}, {}, {}, {id: "minecraft:leather_horse_armor", Count: 1b}], Invisible: 1b, Marker: 1b, Rotation: [0.0f, 0.0f]}
execute if data storage bob:data {Rotation: "east"} run summon minecraft:armor_stand ~ ~0.5625 ~ {Tags: ["bob", "bob.banner_pattern", "bob.updated", "bob.new"], ArmorItems: [{}, {}, {}, {id: "minecraft:leather_horse_armor", Count: 1b}], Invisible: 1b, Marker: 1b, Rotation: [90.0f, 0.0f]}
execute if data storage bob:data {Rotation: "south"} run summon minecraft:armor_stand ~ ~0.5625 ~ {Tags: ["bob", "bob.banner_pattern", "bob.updated", "bob.new"], ArmorItems: [{}, {}, {}, {id: "minecraft:leather_horse_armor", Count: 1b}], Invisible: 1b, Marker: 1b, Rotation: [180.0f, 0.0f]}
execute as @e[type=minecraft:armor_stand, tag=bob.new, limit=1] run function bob:place_banner/as_armor_stand

# Loop this function
scoreboard players add $height bob 1
scoreboard players remove $patterns bob 1
execute if score $patterns bob matches 1.. positioned ~ ~0.00005 ~ run function bob:place_banner/summon_stand